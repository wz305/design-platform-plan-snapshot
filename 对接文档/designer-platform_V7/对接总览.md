# designer-platform_V7 对接总览（单文档版）

本文件用于对接方快速理解 V7 浏览器侧工程：项目定位、结构、依赖与关键系统设计概览。

---

## 1. 项目定位
- V7 是浏览器端 UI 与 ADMock 运行环境，用于模拟/调试与可视化，不作为 AD 侧脚本入口。
- 技术栈为 Vite + React（TypeScript/JS 混合）+ Tailwind + MUI/Radix 组件生态。

---

## 2. 启动与构建
- 安装依赖：`npm i`
- 开发模式：`npm run dev`
- 构建产物：`npm run build`（输出在 `dist/`）

入口文件：`index.html` -> `src/main.tsx`

---

## 3. 目录结构（核心）
```
designer-platform_V7/
  dist/                      # 构建产物
  guidelines/                # 设计/生成规范模板
  src/
    main.tsx                 # 应用入口
    app/                     # 主界面与组件
      App.tsx
      components/
        figma/               # Figma 导出的通用组件
        ui/                  # 基础 UI 组件（Radix/MUI 封装）
        DockablePanel.tsx
        GlobalControls.tsx
        RadialMenu.tsx
        ThemeButton.tsx
    admock_es3/              # ES3 兼容的 AD Mock 运行时核心
      docs/AD_PCB_Mock与任务系统设计_v0.2.md
      task_runtime_core.js
      step_registry.js
      mock_cad_adapter.js
      mock_pcbserver_factory.js
      mock_iterator.js
      mock_board_store.js
      util_logger.js
      util_timestamp.js
      ref_resolver.js
      entry_export_admock_es3.js
      module_exporter.js
      demo_runner.ts
    dev/                     # 开发辅助面板
      DevADMockLauncher.tsx
      connection-panel.js
      diagnostics-panel.js
    dev_console/             # 开发控制台/桥接
      DevConsoleView.tsx
      console_bridge.ts
      dev_console_bus.ts
      dev_console_types.ts
    styles/                  # 全局样式与主题
      index.css
      theme.css
      tailwind.css
      fonts.css
```

---

## 4. 系统设计概要

### 4.1 ADMock ES3 运行时（核心对接点）
目标是让 Task DSL 在浏览器 Mock 与 AD 脚本（ES3）双端一致执行。

关键设计要点（详细见 `admock_es3/docs/AD_PCB_Mock与任务系统设计_v0.2.md`）：
- Task 统一使用 `tcoord`（整数坐标），UI 输入仅负责单位转换。
- 运行时以 Step/Task 状态机驱动，输出统一 Result 结构。
- Adapter 层抽象 AD API 调用面，Mock 与 AD 侧仅适配器不同。

### 4.2 UI 结构
- `src/app`：主界面与交互组件，包含 Dock 面板、全局控制、径向菜单等。
- `src/app/components/ui`：基础 UI 组件库封装，便于组合与主题统一。
- `src/dev` / `src/dev_console`：用于调试、诊断、日志与运行时控制的开发工具面板。

---

## 5. 依赖与技术栈（摘取重点）

### 5.1 构建与样式
- Vite 6.x
- TailwindCSS 4.x（通过 `@tailwindcss/vite`）
- PostCSS

### 5.2 UI 组件生态
- MUI (`@mui/material`, `@mui/icons-material`)
- Radix UI 系列（弹窗、菜单、表单、导航等）
- shadcn/ui 组件来自模板（授权见 `ATTRIBUTIONS.md`）

### 5.3 交互与可视化
- `react-dnd` / `react-resizable-panels`
- `recharts`
- `embla-carousel-react`
- `motion` / `animejs`

### 5.4 表单与工具
- `react-hook-form`
- `date-fns`
- `clsx` / `tailwind-merge`

---

## 6. 资源与授权
- 组件/模板授权说明：`ATTRIBUTIONS.md`
- 设计/生成规范模板：`guidelines/Guidelines.md`

---

## 7. 对接建议关注点
- ADMock 运行时为 ES3 兼容“可迁移小岛”，应保持与 AD 侧脚本一致的数据模型与任务协议。
- UI 层单位转换与 Task 生成逻辑与 `tcoord` 规则绑定，需避免在运行时再次换算。
- 若要与 AD21_JS_Project 对接，建议优先对齐 Task 协议与 Adapter Contract。

---

## 8. 对接文档入口
- `README.md`：项目简介与运行说明
- `admock_es3/docs/AD_PCB_Mock与任务系统设计_v0.2.md`：任务系统设计与协议
- `ATTRIBUTIONS.md`：授权声明
- `guidelines/Guidelines.md`：设计/生成规则模板
