# ğŸ“„ **ç³»ç»Ÿæ¶æ„è®¾è®¡.md**

ï¼ˆç³»ç»Ÿæ¶æ„æ¨¡å¼ä¸æˆåŠŸå®è·µï¼‰

````markdown
# AD ES3 ç³»ç»Ÿæ¶æ„è®¾è®¡

## ğŸ—ï¸ æ¨¡å—ç»“æ„å›¾

```mermaid
flowchart TD

%% ============
%% Module Base
%% ============

A[Module Folder] --> B[index.js]
A --> C[core.js]
A --> D[types.js]
A --> E[tools.js]
A --> F[steps/]
A --> G[logic/]

%% index.js
B --> B1[Constructor Only]
B --> B2[Prototype Method Bindings]
B --> B3[Public API Only]

%% core.js
C --> C1[init() / run()]
C --> C2[Calls step_xxx.js]
C --> C3[Manages context + state]

%% types.js
D --> D1[Data Struct Constructors]
D --> D2[No Side Effects]

%% tools.js
E --> E1[_xxx Private Helpers]
E --> E2[Pure Utility Functions]

%% Steps
F --> F1[Step: scan/analyze/...]
F --> F2[Small & Focused]

%% Logic
G --> G1[Algorithms: merge/BFS/...]
G --> G2[No Logging]
```

## ğŸ¯ æ ¸å¿ƒæˆåŠŸæ¨¡å¼

### 1. UIé©±åŠ¨çš„æ—¥å¿—éªŒè¯æ¨¡å¼
**æè¿°**ï¼šé€šè¿‡UIç•Œé¢ç¡®ä¿æ—¥å¿—ç³»ç»Ÿçš„å¯é è¾“å‡ºå’ŒéªŒè¯

**æ ¸å¿ƒè¦ç´ **ï¼š
- UIç•Œé¢ä½œä¸ºæ—¥å¿—è¾“å‡ºçš„éªŒè¯çª—å£
- å®æ—¶æ˜¾ç¤ºæ—¥å¿—è¾“å‡ºçŠ¶æ€
- å¯è§†åŒ–ç¡®è®¤æ—¥å¿—ç³»ç»Ÿæ­£å¸¸è¿è¡Œ

**å®æ–½è¦ç‚¹**ï¼š
```js
// UIéªŒè¯ç¤ºä¾‹
function validateLoggerOutput() {
    var testMessage = "[TestModule][validation][validateLoggerOutput] UIéªŒè¯æµ‹è¯•æ¶ˆæ¯";
    logger.debug(testMessage);
    
    // æ£€æŸ¥UIæ˜¯å¦æ˜¾ç¤ºè¯¥æ¶ˆæ¯
    var isDisplayed = checkUIDisplay(testMessage);
    if (!isDisplayed) {
        throw new Error("æ—¥å¿—ç³»ç»ŸUIéªŒè¯å¤±è´¥");
    }
}
```

**ä¼˜åŠ¿**ï¼š
- ç¡®ä¿æ—¥å¿—ç³»ç»Ÿåœ¨çœŸå®ç¯å¢ƒä¸­å¯ç”¨
- æä¾›å³æ—¶çš„åé¦ˆæœºåˆ¶
- é™ä½è°ƒè¯•éš¾åº¦

### 2. å®Œæ•´å‡½æ•°ç”Ÿå‘½å‘¨æœŸæ—¥å¿—æ¨¡å¼
**æè¿°**ï¼šæ¯ä¸ªå‡½æ•°éƒ½å¿…é¡»è®°å½•å®Œæ•´çš„ç”Ÿå‘½å‘¨æœŸä¿¡æ¯

**å››ä¸ªå…³é”®ç‚¹**ï¼š
1. **START** - å‡½æ•°å¼€å§‹ï¼Œè®°å½•ä¼ å…¥å‚æ•°
2. **CONTEXT** - å…³é”®å†…éƒ¨çŠ¶æ€å˜åŒ–
3. **SUCCESS** - å‡½æ•°æˆåŠŸæ‰§è¡Œï¼Œè®°å½•è¿”å›å€¼
4. **ERROR** - å¼‚å¸¸å¤„ç†ï¼Œè®°å½•é”™è¯¯è¯¦æƒ…

**æ ‡å‡†æ¨¡æ¿**ï¼š
```js
function functionName(param1, param2) {
    logger.debug("[ModuleName][fileName][functionName] START - params: " + JSON.stringify({
        param1: param1,
        param2: param2
    }));
    
    try {
        // å…³é”®å†…éƒ¨çŠ¶æ€
        logger.debug("[ModuleName][fileName][functionName] CONTEXT - state: " + JSON.stringify(internalState));
        
        var result = doSomething();
        
        logger.debug("[ModuleName][fileName][functionName] SUCCESS - result: " + JSON.stringify(result));
        return result;
        
    } catch (error) {
        logger.error("[ModuleName][fileName][functionName] ERROR - " + error.message);
        throw error;
    }
}
```

**ä¼˜åŠ¿**ï¼š
- æä¾›å®Œæ•´çš„å‡½æ•°æ‰§è¡Œè½¨è¿¹
- ä¾¿äºé—®é¢˜å®šä½å’Œè°ƒè¯•
- æ”¯æŒæ€§èƒ½åˆ†æ

### 3. ç¦æ­¢é™é»˜å¤„ç†é™çº§æ¨¡å¼
**æè¿°**ï¼šæ‰€æœ‰é”™è¯¯ã€å¼‚å¸¸ã€é™çº§éƒ½å¿…é¡»è®°å½•åˆ°æ—¥å¿—ç³»ç»Ÿ

**æ ¸å¿ƒåŸåˆ™**ï¼š
- **ä¸å…è®¸é™é»˜å¤±è´¥**ï¼šä»»ä½•catchå—éƒ½å¿…é¡»è®°å½•æ—¥å¿—
- **ä¸å…è®¸å¿½ç•¥é™çº§**ï¼šåŠŸèƒ½é™çº§å¿…é¡»è®°å½•åŸå› å’Œå½±å“
- **ä¸å…è®¸ä¸¢å¤±ä¸Šä¸‹æ–‡**ï¼šé”™è¯¯æ—¥å¿—å¿…é¡»åŒ…å«è¶³å¤Ÿçš„ä¸Šä¸‹æ–‡ä¿¡æ¯

**å®æ–½è§„èŒƒ**ï¼š
```js
// æ­£ç¡®çš„é”™è¯¯å¤„ç†
try {
    riskyOperation();
} catch (error) {
    logger.error("[ModuleName][fileName][functionName] ERROR - æ“ä½œå¤±è´¥: " + error.message + 
                ", ä¸Šä¸‹æ–‡: " + JSON.stringify(context) + 
                ", å½±å“èŒƒå›´: " + getImpactScope());
    
    // é™çº§å¤„ç†
    performFallback();
    logger.warn("[ModuleName][fileName][functionName] FALLBACK - å·²å¯ç”¨é™çº§æ–¹æ¡ˆ");
}

// ç¦æ­¢çš„é™é»˜å¤„ç†
try {
    riskyOperation();
} catch (error) {
    // é™é»˜å¿½ç•¥ - ä¸¥ç¦è¿™æ ·åšï¼
}
```

**ä¼˜åŠ¿**ï¼š
- ç¡®ä¿æ‰€æœ‰é—®é¢˜éƒ½å¯è¿½è¸ª
- æä¾›å®Œæ•´çš„ç³»ç»Ÿå¥åº·çŠ¶æ€
- æ”¯æŒé—®é¢˜æ ¹å› åˆ†æ

### 4. å®‰å…¨UIä¿¡æ¯è¾“å‡ºæ¨¡å¼
**æè¿°**ï¼šUIä¿¡æ¯è¾“å‡ºé‡‡ç”¨å®‰å…¨æ–¹å¼ï¼Œä¿æŠ¤æ•æ„Ÿä¿¡æ¯

**å®‰å…¨æªæ–½**ï¼š
- **ä¿¡æ¯è¿‡æ»¤**ï¼šè¿‡æ»¤æ•æ„Ÿä¿¡æ¯ï¼ˆå¯†ç ã€å¯†é’¥ç­‰ï¼‰
- **ä¿¡æ¯è„±æ•**ï¼šå¯¹æ•æ„Ÿæ•°æ®è¿›è¡Œè„±æ•å¤„ç†
- **æƒé™æ§åˆ¶**ï¼šæ ¹æ®ç”¨æˆ·æƒé™æ§åˆ¶ä¿¡æ¯æ˜¾ç¤º
- **æ ¼å¼åŒ–**ï¼šç»Ÿä¸€é”™è¯¯ä¿¡æ¯æ ¼å¼

**å®æ–½ç¤ºä¾‹**ï¼š
```js
function safeUIOutput(data, userLevel) {
    var filteredData = filterSensitiveData(data, userLevel);
    var formattedData = formatForDisplay(filteredData);
    
    logger.debug("[UIModule][output][safeUIOutput] OUTPUT - level: " + userLevel + 
                ", data: " + JSON.stringify(formattedData));
    
    return formattedData;
}

function filterSensitiveData(data, userLevel) {
    var result = {};
    for (var key in data) {
        if (isSensitiveField(key) && userLevel < ADMIN_LEVEL) {
            result[key] = "***";
        } else {
            result[key] = data[key];
        }
    }
    return result;
}
```

**ä¼˜åŠ¿**ï¼š
- ä¿æŠ¤ç³»ç»Ÿå®‰å…¨
- ç¬¦åˆå®‰å…¨åˆè§„è¦æ±‚
- æä¾›è‰¯å¥½çš„ç”¨æˆ·ä½“éªŒ

## ğŸ—ï¸ æ¶æ„æ¨¡å¼

### 1. å¤§IIFEæ¨¡å—æ¨¡å¼
**æè¿°**ï¼šåŸºäºå¤§IIFEçš„ç»Ÿä¸€æ¨¡å—æ¶æ„

**æ ¸å¿ƒç‰¹å¾**ï¼š
- ç»Ÿä¸€çš„ç”Ÿå‘½å‘¨æœŸç®¡ç†
- æ ‡å‡†åŒ–çš„Hookç³»ç»Ÿ
- ES3ç¯å¢ƒå®Œå…¨å…¼å®¹

**æ ‡å‡†ç»“æ„**ï¼š
```js
var ModuleName = (function(){
    // ç§æœ‰å˜é‡å’Œå‡½æ•°
    var privateVar = {};
    
    function privateFunction() {
        // ç§æœ‰é€»è¾‘
    }
    
    // å…¬å…±æ¥å£
    return {
        create: create,
        init: init,
        run: run,
        destroy: destroy
    };
})();
```

### 2. æ­ç¤ºæ¨¡å—æ¨¡å¼
**æè¿°**ï¼šä½¿ç”¨IIFEåˆ›å»ºçœŸæ­£çš„ç§æœ‰ä½œç”¨åŸŸ

**ä¼˜åŠ¿**ï¼š
- çœŸæ­£çš„ç§æœ‰å˜é‡å’Œæ–¹æ³•
- æ¸…æ™°çš„å…¬å…±æ¥å£
- ES3ç¯å¢ƒå®Œå…¨å…¼å®¹

### 3. ç®€å•ä¼˜å…ˆæ¨¡å¼
**æè¿°**ï¼šä¼˜å…ˆä½¿ç”¨ç®€å•çš„è§£å†³æ–¹æ¡ˆï¼Œé¿å…è¿‡åº¦å·¥ç¨‹åŒ–

**é€‰æ‹©åŸåˆ™**ï¼š
- åŠŸèƒ½ç®€å• â†’ ç®€å•æ¨¡å—æ¨¡å¼
- éœ€è¦çŠ¶æ€ç®¡ç† â†’ å¤§IIFEæ¨¡å¼
- æœªæ¥éœ€æ±‚ä¸ç¡®å®š â†’ ç®€å•æ¨¡å¼

## ğŸ”„ å¼€å‘æµç¨‹æ¨¡å¼

### 1. æ¸è¿›å¼é‡æ„æ¨¡å¼
**æè¿°**ï¼šåˆ†é˜¶æ®µè¿›è¡Œç³»ç»Ÿé‡æ„ï¼Œé™ä½é£é™©

**å®æ–½æ­¥éª¤**ï¼š
1. å»ºç«‹æ–°æ¶æ„åŸºç¡€
2. é€ä¸ªæ¨¡å—è¿ç§»
3. ä¿æŒAPIå…¼å®¹æ€§
4. é€æ­¥ç§»é™¤æ—§ä»£ç 

### 2. UIéªŒè¯ä¼˜å…ˆæ¨¡å¼
**æè¿°**ï¼šé€šè¿‡UIç•Œé¢éªŒè¯ç³»ç»ŸåŠŸèƒ½

**éªŒè¯æµç¨‹**ï¼š
1. å¼€å‘åŠŸèƒ½
2. é›†æˆæ—¥å¿—
3. UIéªŒè¯è¾“å‡º
4. ç¡®è®¤åŠŸèƒ½æ­£å¸¸

### 3. è§„åˆ™é©±åŠ¨å¼€å‘æ¨¡å¼
**æè¿°**ï¼šåŸºäºæ˜ç¡®çš„è§„åˆ™è¿›è¡Œå¼€å‘

**è§„åˆ™ä½“ç³»**ï¼š
- æ ¸å¿ƒè§„åˆ™ï¼ˆä¸å¯è¿èƒŒï¼‰
- åå•†è§„åˆ™ï¼ˆæµç¨‹æŒ‡å¯¼ï¼‰
- æœ€ä½³å®è·µï¼ˆç»éªŒæ€»ç»“ï¼‰

## ğŸ“Š è´¨é‡ä¿è¯æ¨¡å¼

### 1. ES3å…¼å®¹æ€§ä¿è¯æ¨¡å¼
**æè¿°**ï¼šç¡®ä¿æ‰€æœ‰ä»£ç åœ¨ADç¯å¢ƒä¸­å¯è¿è¡Œ

**æ£€æŸ¥è¦ç‚¹**ï¼š
- è¯­æ³•å…¼å®¹æ€§ï¼ˆES3è¯­æ³•ï¼‰
- APIå…¼å®¹æ€§ï¼ˆé¿å…ç°ä»£APIï¼‰
- ç¯å¢ƒå…¼å®¹æ€§ï¼ˆæ— windowã€thisç­‰ï¼‰

### 2. æ—¥å¿—è¦†ç›–æ¨¡å¼
**æè¿°**ï¼šç¡®ä¿æ‰€æœ‰å…³é”®è·¯å¾„éƒ½æœ‰æ—¥å¿—è¦†ç›–

**è¦†ç›–è¦æ±‚**ï¼š
- æ‰€æœ‰å…¬å…±å‡½æ•°
- æ‰€æœ‰é”™è¯¯å¤„ç†è·¯å¾„
- æ‰€æœ‰å…³é”®å†³ç­–ç‚¹
- æ‰€æœ‰çŠ¶æ€å˜åŒ–

### 3. æµ‹è¯•é©±åŠ¨éªŒè¯æ¨¡å¼
**æè¿°**ï¼šé€šè¿‡æµ‹è¯•éªŒè¯ç³»ç»Ÿå¯é æ€§

**æµ‹è¯•å±‚æ¬¡**ï¼š
- å•å…ƒæµ‹è¯•ï¼ˆå‡½æ•°çº§åˆ«ï¼‰
- é›†æˆæµ‹è¯•ï¼ˆæ¨¡å—çº§åˆ«ï¼‰
- ç³»ç»Ÿæµ‹è¯•ï¼ˆæ•´ä½“çº§åˆ«ï¼‰
- ç¯å¢ƒæµ‹è¯•ï¼ˆADç¯å¢ƒï¼‰

## ğŸ¯ æˆåŠŸæŒ‡æ ‡

### ä»£ç è´¨é‡æŒ‡æ ‡
- **ES3å…¼å®¹æ€§**ï¼š100%
- **æ—¥å¿—è¦†ç›–ç‡**ï¼š>95%
- **é”™è¯¯å¤„ç†è¦†ç›–ç‡**ï¼š100%
- **å®‰å…¨åˆè§„æ€§**ï¼š100%

### å¯ç»´æŠ¤æ€§æŒ‡æ ‡
- **è§„åˆ™éµå¾ªåº¦**ï¼š>95%
- **æ–‡æ¡£å®Œæ•´æ€§**ï¼š>90%
- **ä»£ç é‡å¤ç‡**ï¼š<10%

### å¯é æ€§æŒ‡æ ‡
- **åŠŸèƒ½å¯ç”¨æ€§**ï¼š>99%
- **é”™è¯¯è¿½è¸ªç‡**ï¼š100%
- **é™çº§è®°å½•ç‡**ï¼š100%

````

**æ­¤æ–‡ä»¶è®°å½•ç³»ç»Ÿæ¶æ„çš„æˆåŠŸæ¨¡å¼ï¼Œä¸ºæœªæ¥å¼€å‘æä¾›å‚è€ƒã€‚**
