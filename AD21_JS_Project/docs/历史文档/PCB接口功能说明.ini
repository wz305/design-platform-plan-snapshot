我来从接口调用的角度为您详细解释这个PCB接口模块提供了什么功能。

## PCB接口模块功能概览

这个模块是一个**PCB设计对象的统一封装系统**，主要提供以下几类功能：

### 1. 模块管理功能（主入口）

```javascript
// 初始化模块
PCBInterfaces.initialize({
    enableMock: true,    // 启用Mock模式（用于测试）
    maxPoolSize: 100     // 对象池大小
});

// 检查模块状态
PCBInterfaces.isReady()           // 返回 true/false
PCBInterfaces.getSupportedTypes()  // 返回支持的对象类型数组

// 获取统计信息
PCBInterfaces.getStatistics()     // 返回创建的对象数量、池状态等

// 清理资源
PCBInterfaces.cleanup()
```

### 2. 对象创建功能

#### 创建真实PCB对象封装
```javascript
// 创建Arc（圆弧）对象封装
var arcWrapper = PCBInterfaces.createWrapper("Arc", {
    nativeObject: realArcObject,  // AD中的真实IPCB_Arc对象
    enableCache: true
});

// 创建Pad（焊盘）对象封装
var padWrapper = PCBInterfaces.createWrapper("Pad", {
    nativeObject: realPadObject
});

// 创建Track（走线）对象封装
var trackWrapper = PCBInterfaces.createWrapper("Track", {
    nativeObject: realTrackObject
});

// 创建Via（过孔）对象封装
var viaWrapper = PCBInterfaces.createWrapper("Via", {
    nativeObject: realViaObject
});
```

#### 创建Mock对象（用于测试）
```javascript
// 创建Mock Arc对象
var mockArc = PCBInterfaces.createMock("Arc", {
    centerX: 10,
    centerY: 20,
    radius: 5,
    startAngle: 0,
    endAngle: 90
});

// 创建Mock Pad对象
var mockPad = PCBInterfaces.createMock("Pad", {
    x: 15,
    y: 25,
    sizeX: 2,
    sizeY: 1,
    shape: "Rect"
});
```

#### 批量创建（从AD迭代器）
```javascript
// 从AD迭代器批量创建封装对象
var wrappers = PCBInterfaces.createFromIterator(boardIterator, "Track");
```

### 3. 对象属性访问功能

每个封装对象都提供统一的属性访问接口：

#### Arc（圆弧）对象
```javascript
var arc = PCBInterfaces.createMock("Arc", {
    centerX: 10, centerY: 20, radius: 5,
    startAngle: 0, endAngle: 90
});

// 基本属性
arc.getCenterX()     // 10
arc.getCenterY()     // 20
arc.getRadius()       // 5
arc.getStartAngle()    // 0
arc.getEndAngle()      // 90
arc.getLineWidth()    // 0.1 (默认)

// 计算属性
arc.getStartPoint()    // {x: 15, y: 20} - 起点
arc.getEndPoint()      // {x: 10, y: 25} - 终点
arc.getArcLength()     // 7.85 - 弧长
arc.getBoundingBox()   // {x1:5, y1:15, x2:15, y2:25} - 包围盒

// 操作方法
arc.isPointOnArc(15, 20, 0.01)  // true - 检查点是否在弧上
arc.reverse()                    // 反转圆弧方向

// 完整信息
var arcInfo = arc.getArcInfo()
// 返回包含所有属性的对象
```

#### Pad（焊盘）对象
```javascript
var pad = PCBInterfaces.createMock("Pad", {
    x: 15, y: 25, sizeX: 2, sizeY: 1, shape: "Rect"
});

// 基本属性
pad.getX()           // 15
pad.getY()           // 25
pad.getSizeX()       // 2
pad.getSizeY()       // 1
pad.getShape()       // "Rect"
pad.getHoleSize()    // 0 (默认无孔)

// 计算属性
pad.getArea()           // 2 - 面积
pad.getBoundingBox()    // {x1:14, y1:24.5, x2:16, y2:25.5}

// 检查方法
pad.isPointInPad(15, 25)  // true - 检查点是否在焊盘内

// 电气特性
var electrical = pad.getElectricalProperties()
// {netName: "", resistance: 0, capacitance: 0, impedance: 50}

// 完整信息
var padInfo = pad.getPadInfo()
```

#### Track（走线）对象
```javascript
var track = PCBInterfaces.createMock("Track", {
    x1: 0, y1: 0, x2: 10, y2: 10, width: 0.5
});

// 基本属性
track.getX1()      // 0
track.getY1()      // 0
track.getX2()      // 10
track.getY2()      // 10
track.getWidth()   // 0.5
track.getLayer()   // {Name: "Top Layer"}

// 计算属性
track.getLength()      // 14.14 - 长度
track.getAngle()       // 45 - 角度
track.getMidPoint()    // {x:5, y:5} - 中点
track.getBoundingBox() // {x1:-0.25, y1:-0.25, x2:10.25, y2:10.25}

// 电气特性
var electrical = track.getElectricalProperties()
// {netName: "", resistance: 0.014, capacitance: 2.83, impedance: 35}

// 完整信息
var trackInfo = track.getTrackInfo()
```

#### Via（过孔）对象
```javascript
var via = PCBInterfaces.createMock("Via", {
    x: 5, y: 5, holeSize: 0.2, size: 0.5
});

// 基本属性
via.getX()           // 5
via.getY()           // 5
via.getHoleSize()    // 0.2
via.getSize()        // 0.5
via.getStartLayer()   // {Name: "Top Layer"}
via.getEndLayer()     // {Name: "Bottom Layer"}
via.getViaType()     // "Through"
via.isPlated()       // true

// 计算属性
via.getArea()         // 0.196 - 过孔面积
via.getHoleArea()     // 0.031 - 孔面积
via.getRingArea()     // 0.165 - 环面积

// 电气特性
var electrical = via.getElectricalProperties()
// {netName: "", resistance: 0.001, capacitance: 0.5, inductance: 1, impedance: 25}

// 机械特性
var mechanical = via.getMechanicalProperties()
// {plated: true, viaType: "Through", aspectRatio: 8, ...}

// 完整信息
var viaInfo = via.getViaInfo()
```

### 4. 几何计算功能

独立的几何计算器，可用于各种计算：

```javascript
var calc = PCBInterfaces.GeometryCalculator;

// 基础几何计算
calc.calculateDistance(0, 0, 3, 4)           // 5 - 距离
calc.calculateAngle(0, 0, 1, 0)             // 0 - 角度
calc.calculateMidPoint(0, 0, 2, 2)           // {x:1, y:1} - 中点

// 圆形计算
calc.calculateCircleArea(1)                  // 3.14 - 圆面积
calc.calculateCircleBoundingBox(10, 20, 5)   // 包围盒
calc.isPointInCircle(3, 4, 0, 0, 5)        // true - 点在圆内

// 矩形计算
calc.calculateRectBoundingBox(15, 25, 2, 1)   // 矩形包围盒
calc.calculatePadArea(2, 1, "Rect")          // 2 - 焊盘面积

// 走线计算
calc.calculateTrackBoundingBox(0, 0, 10, 10, 0.5)  // 走线包围盒
calc.calculateTrackResistance(14.14, 0.5, 0.035)   // 0.014 - 电阻
calc.calculateTrackCapacitance(14.14, 0.5, layer)  // 2.83 - 电容
calc.calculateTrackImpedance(0.5, 0.035, layer)    // 35 - 阻抗

// 过孔计算
calc.calculateViaResistance(0.5, 0.2, startLayer, endLayer)  // 0.001 - 电阻
calc.calculateViaCapacitance(0.5, 0.2, startLayer, endLayer) // 0.5 - 电容
calc.calculateViaAspectRatio(startLayer, endLayer, 0.2)      // 8 - 纵横比
```

### 5. 对象池管理功能

```javascript
// 获取不同类型的对象池
var wrappedPool = PCBInterfaces.getObjectPool("wrapped")   // 封装对象池
var nativePool = PCBInterfaces.getObjectPool("native")     // 原生对象池
var modifiedPool = PCBInterfaces.getObjectPool("modified")  // 修改对象池

// 对象池用于缓存和管理对象，提高性能
```

## 核心价值

1. **统一接口**：所有PCB对象都有相同的调用方式
2. **Mock支持**：可以创建测试用的虚拟对象
3. **计算功能**：内置丰富的几何和电气计算
4. **AD兼容**：完全兼容Altium Designer的JScript环境
5. **性能优化**：对象池和属性缓存机制

这个模块让您可以用统一的方式操作PCB设计中的各种对象，无论是真实的AD对象还是测试用的Mock对象，都有一致的API接口。